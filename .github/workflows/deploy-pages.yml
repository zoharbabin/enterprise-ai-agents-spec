name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
    paths:
      - 'roo-code-setup/**'
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Create Pages structure
        run: |
          mkdir -p _site
          
          # Copy the Enterprise Roo setup script
          cp roo-code-setup/enterprise_roo_setup.sh _site/
          
          # Copy all templates and instructions
          cp -r roo-code-setup/templates _site/
          cp -r roo-code-setup/instruction-templates _site/
          
          # Create an index.html for the GitHub Pages site
          cat > _site/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>Enterprise Roo Code Setup</title>
              <style>
                  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
                  .hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 10px; text-align: center; margin-bottom: 30px; }
                  .command-box { background: #f6f8fa; border: 1px solid #d0d7de; border-radius: 6px; padding: 16px; margin: 20px 0; font-family: 'SFMono-Regular', Consolas, monospace; }
                  .features { display: grid; gap: 20px; margin: 30px 0; }
                  .feature { background: #f6f8fa; padding: 20px; border-radius: 8px; border-left: 4px solid #0969da; }
                  .modes { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
                  .mode { background: white; border: 1px solid #d0d7de; padding: 15px; border-radius: 8px; text-align: center; }
              </style>
          </head>
          <body>
              <div class="hero">
                  <h1>🚀 Enterprise Roo Code Setup</h1>
                  <p>Full enterprise AI agent coordination with 12 specialized modes</p>
              </div>

              <h2>🎯 Quick Start</h2>
              <p>Run the enterprise setup script directly from GitHub Pages (no caching issues):</p>
              <div class="command-box">
                  <code>curl -sSL https://zoharbabin.github.io/enterprise-ai-agents-spec/enterprise_roo_setup.sh | bash -s -- ./my-project</code>
              </div>

              <div class="features">
                  <div class="feature">
                      <h3>🏢 Enterprise Features</h3>
                      <ul>
                          <li>12 Specialized Enterprise Modes</li>
                          <li>Automatic Workflow Orchestration</li>
                          <li>Quality Gates & Stakeholder Approvals</li>
                          <li>Comprehensive Security Framework</li>
                      </ul>
                  </div>
              </div>

              <h2>🎯 Available Enterprise Modes</h2>
              <div class="modes">
                  <div class="mode"><strong>🪃 Orchestrator</strong><br>Project coordination</div>
                  <div class="mode"><strong>🏗️ Architect</strong><br>System architecture</div>
                  <div class="mode"><strong>💻 Code</strong><br>Senior development</div>
                  <div class="mode"><strong>🪲 Debug</strong><br>QA specialist</div>
                  <div class="mode"><strong>🔧 DevOps</strong><br>Infrastructure automation</div>
                  <div class="mode"><strong>🛡️ Security</strong><br>Cybersecurity specialist</div>
                  <div class="mode"><strong>⚡ Performance</strong><br>Performance engineering</div>
                  <div class="mode"><strong>📊 Product</strong><br>Product management</div>
                  <div class="mode"><strong>⚖️ Compliance</strong><br>Regulatory compliance</div>
                  <div class="mode"><strong>🔬 Research</strong><br>Market & tech research</div>
                  <div class="mode"><strong>📚 Documentation</strong><br>Technical documentation</div>
                  <div class="mode"><strong>📈 Data</strong><br>Data engineering</div>
              </div>

              <h2>📋 Installation Options</h2>
              <div class="command-box">
                  <strong>Install all modes:</strong><br>
                  <code>curl -sSL https://zoharbabin.github.io/enterprise-ai-agents-spec/enterprise_roo_setup.sh | bash -s -- ./my-project</code>
              </div>
              
              <div class="command-box">
                  <strong>Install specific modes:</strong><br>
                  <code>curl -sSL https://zoharbabin.github.io/enterprise-ai-agents-spec/enterprise_roo_setup.sh | bash -s -- -m orchestrator,code,security ./my-project</code>
              </div>

              <div class="command-box">
                  <strong>Interactive mode selection:</strong><br>
                  <code>curl -sSL https://zoharbabin.github.io/enterprise-ai-agents-spec/enterprise_roo_setup.sh | bash -s -- -i ./my-project</code>
              </div>

              <h2>🔗 Resources</h2>
              <ul>
                  <li><a href="https://github.com/zoharbabin/enterprise-ai-agents-spec">GitHub Repository</a></li>
                  <li><a href="./enterprise_roo_setup.sh">Download Script Directly</a></li>
                  <li><a href="./templates/">View Templates</a></li>
                  <li><a href="./instruction-templates/">View Mode Instructions</a></li>
              </ul>

              <footer style="margin-top: 50px; padding-top: 20px; border-top: 1px solid #d0d7de; text-align: center; color: #656d76;">
                  <p>Enterprise Roo Code Setup - Ready for Enterprise-Grade AI-Powered Software Development</p>
              </footer>
          </body>
          </html>
          EOF
          
          # Create a simple directory listing for templates
          cat > _site/templates/index.html << 'EOF'
          <!DOCTYPE html>
          <html>
          <head><title>Templates</title></head>
          <body>
              <h1>Enterprise Roo Code Templates</h1>
              <ul>
                  <li><a href="roomodes.yaml">roomodes.yaml</a> - Main configuration</li>
                  <li><a href="rooignore">rooignore</a> - Security exclusions</li>
                  <li><a href="README.md">README.md</a> - Project documentation</li>
              </ul>
          </body>
          </html>
          EOF
          
          # Create a directory listing for instruction templates
          cat > _site/instruction-templates/index.html << 'EOF'
          <!DOCTYPE html>
          <html>
          <head><title>Instruction Templates</title></head>
          <body>
              <h1>Enterprise Mode Instructions</h1>
              <ul>
                  <li><a href="orchestrator.md">orchestrator.md</a></li>
                  <li><a href="architect.md">architect.md</a></li>
                  <li><a href="code.md">code.md</a></li>
                  <li><a href="debug.md">debug.md</a></li>
                  <li><a href="devops.md">devops.md</a></li>
                  <li><a href="security.md">security.md</a></li>
                  <li><a href="performance.md">performance.md</a></li>
                  <li><a href="product.md">product.md</a></li>
                  <li><a href="compliance.md">compliance.md</a></li>
                  <li><a href="research.md">research.md</a></li>
                  <li><a href="docs.md">docs.md</a></li>
                  <li><a href="data.md">data.md</a></li>
                  <li><a href="version.json">version.json</a></li>
              </ul>
          </body>
          </html>
          EOF

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3

  deploy:
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4